<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gotcha Guardian - Payment Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://www.paypal.com/sdk/js?client-id={{ paypal_client_id }}&currency=USD"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
                        <span class="text-purple-600 font-bold text-xl">G</span>
                    </div>
                    <h1 class="text-2xl font-bold">Gotcha Guardian</h1>
                </div>
                <nav class="hidden md:flex space-x-6">
                    <a href="#products" class="hover:text-purple-200 transition-colors">Products</a>
                    <a href="#features" class="hover:text-purple-200 transition-colors">Features</a>
                    <a href="#support" class="hover:text-purple-200 transition-colors">Support</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12">
        <!-- Hero Section -->
        <section class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-800 mb-4">Advanced System Monitoring & Protection</h2>
            <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
                Protect your system with our advanced monitoring software. Real-time threat detection, 
                comprehensive activity logging, and intelligent anomaly detection.
            </p>
        </section>

        <!-- Products Section -->
        <section id="products" class="mb-16">
            <h3 class="text-3xl font-bold text-center text-gray-800 mb-12">Choose Your Protection Level</h3>
            <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                <!-- Basic Plan -->
                <div class="bg-white rounded-lg card-shadow p-8 relative">
                    <div class="text-center mb-6">
                        <h4 class="text-2xl font-bold text-gray-800 mb-2">Basic Guardian</h4>
                        <div class="text-4xl font-bold text-purple-600 mb-2">$29.99</div>
                        <p class="text-gray-600">Essential monitoring features</p>
                    </div>
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Real-time system monitoring
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Basic threat detection
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Activity logging
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Email support
                        </li>
                    </ul>
                    <button onclick="selectProduct('basic')" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                        Select Basic
                    </button>
                </div>

                <!-- Pro Plan -->
                <div class="bg-white rounded-lg card-shadow p-8 relative border-2 border-purple-500">
                    <div class="absolute -top-4 left-1/2 transform -translate-x-1/2">
                        <span class="bg-purple-500 text-white px-4 py-1 rounded-full text-sm font-semibold">Most Popular</span>
                    </div>
                    <div class="text-center mb-6">
                        <h4 class="text-2xl font-bold text-gray-800 mb-2">Pro Guardian</h4>
                        <div class="text-4xl font-bold text-purple-600 mb-2">$59.99</div>
                        <p class="text-gray-600">Advanced protection & analytics</p>
                    </div>
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Everything in Basic
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Advanced anomaly detection
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Behavioral analysis
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Custom alerts
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Priority support
                        </li>
                    </ul>
                    <button onclick="selectProduct('pro')" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                        Select Pro
                    </button>
                </div>

                <!-- Enterprise Plan -->
                <div class="bg-white rounded-lg card-shadow p-8 relative">
                    <div class="text-center mb-6">
                        <h4 class="text-2xl font-bold text-gray-800 mb-2">Enterprise Guardian</h4>
                        <div class="text-4xl font-bold text-purple-600 mb-2">$99.99</div>
                        <p class="text-gray-600">Complete security solution</p>
                    </div>
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Everything in Pro
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Multi-system monitoring
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            Advanced reporting
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            API access
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            24/7 phone support
                        </li>
                    </ul>
                    <button onclick="selectProduct('enterprise')" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                        Select Enterprise
                    </button>
                </div>
            </div>
        </section>

        <!-- Payment Section -->
        <section id="payment" class="max-w-md mx-auto bg-white rounded-lg card-shadow p-8" style="display: none;">
            <h3 class="text-2xl font-bold text-center text-gray-800 mb-6">Complete Your Purchase</h3>
            
            <div id="selected-product" class="mb-6 p-4 bg-purple-50 rounded-lg">
                <!-- Selected product details will be inserted here -->
            </div>

            <form id="payment-form" class="space-y-4">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                    <input type="email" id="email" name="email" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                           placeholder="your@email.com">
                </div>
                
                <div id="paypal-button-container" class="mt-6">
                    <!-- PayPal button will be rendered here -->
                </div>
            </form>

            <div class="mt-6 text-center">
                <button onclick="goBack()" class="text-purple-600 hover:text-purple-800 transition-colors">
                    ← Back to Products
                </button>
            </div>
        </section>

        <!-- Success Section -->
        <section id="success" class="max-w-md mx-auto bg-white rounded-lg card-shadow p-8 text-center" style="display: none;">
            <div class="mb-6">
                <svg class="w-16 h-16 text-green-500 mx-auto mb-4" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Payment Successful!</h3>
                <p class="text-gray-600">Thank you for your purchase. Check your email for download instructions.</p>
            </div>
            
            <div id="download-info" class="mb-6 p-4 bg-green-50 rounded-lg">
                <!-- Download information will be inserted here -->
            </div>

            <button onclick="startOver()" class="bg-purple-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                Make Another Purchase
            </button>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2024 Gotcha Guardian. All rights reserved.</p>
            <div class="mt-4 space-x-6">
                <a href="#" class="text-gray-400 hover:text-white transition-colors">Privacy Policy</a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors">Terms of Service</a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors">Support</a>
            </div>
        </div>
    </footer>

    <script>
        let selectedProduct = null;
        let paypalButtonRendered = false;

        const products = {
            basic: {
                id: 'basic',
                name: 'Basic Guardian',
                price: 29.99,
                description: 'Essential monitoring features'
            },
            pro: {
                id: 'pro', 
                name: 'Pro Guardian',
                price: 59.99,
                description: 'Advanced protection & analytics'
            },
            enterprise: {
                id: 'enterprise',
                name: 'Enterprise Guardian', 
                price: 99.99,
                description: 'Complete security solution'
            }
        };

        function selectProduct(productId) {
            selectedProduct = products[productId];
            showPaymentSection();
        }

        function showPaymentSection() {
            document.getElementById('products').style.display = 'none';
            document.getElementById('payment').style.display = 'block';
            
            // Update selected product display
            const productDisplay = document.getElementById('selected-product');
            productDisplay.innerHTML = `
                <h4 class="font-bold text-lg">${selectedProduct.name}</h4>
                <p class="text-gray-600">${selectedProduct.description}</p>
                <p class="text-2xl font-bold text-purple-600 mt-2">$${selectedProduct.price}</p>
            `;

            // Render PayPal button if not already rendered
            if (!paypalButtonRendered) {
                renderPayPalButton();
            }
        }

        function renderPayPalButton() {
            paypal.Buttons({
                createOrder: function(data, actions) {
                    const email = document.getElementById('email').value;
                    if (!email) {
                        alert('Please enter your email address');
                        return;
                    }

                    return fetch('/api/payment/create', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            email: email,
                            product_id: selectedProduct.id
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            return data.data.payment_id;
                        } else {
                            throw new Error(data.error);
                        }
                    })
                    .catch(error => {
                        console.error('Error creating payment:', error);
                        alert('Error creating payment: ' + error.message);
                    });
                },
                onApprove: function(data, actions) {
                    return fetch('/api/payment/execute', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            paymentID: data.paymentID,
                            payerID: data.payerID
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showSuccessSection(data.data);
                        } else {
                            throw new Error(data.error);
                        }
                    })
                    .catch(error => {
                        console.error('Error executing payment:', error);
                        alert('Error processing payment: ' + error.message);
                    });
                },
                onError: function(err) {
                    console.error('PayPal error:', err);
                    alert('Payment error occurred. Please try again.');
                }
            }).render('#paypal-button-container');
            
            paypalButtonRendered = true;
        }

        function showSuccessSection(paymentData) {
            document.getElementById('payment').style.display = 'none';
            document.getElementById('success').style.display = 'block';
            
            // Update download info
            const downloadInfo = document.getElementById('download-info');
            downloadInfo.innerHTML = `
                <h4 class="font-bold mb-2">Download Information</h4>
                <p class="text-sm text-gray-600 mb-2">Activation Key: <code class="bg-gray-200 px-2 py-1 rounded">${paymentData.activation_key}</code></p>
                <p class="text-sm text-gray-600">Download link has been sent to your email address.</p>
            `;
        }

        function goBack() {
            document.getElementById('payment').style.display = 'none';
            document.getElementById('products').style.display = 'block';
        }

        function startOver() {
            document.getElementById('success').style.display = 'none';
            document.getElementById('products').style.display = 'block';
            selectedProduct = null;
            paypalButtonRendered = false;
            document.getElementById('email').value = '';
        }
    </script>
</body>
</html>